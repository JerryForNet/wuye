@{;
ViewBag.Title = "打印保养单";
Layout = "~/Views/Shared/_Form.cshtml";

List<HuRongClub.Application.Entity.TenementManage.DeviceRecordModel> list = ViewBag.list as List<HuRongClub.Application.Entity.TenementManage.DeviceRecordModel>;
}
<style>
    .tdBorder { border: 1px solid gray; }
    .form .formTitle1 { text-align: right; white-space: normal; font-weight: normal; width: 90px; padding-right: 10px; }
    .form .formValue1 { padding-left:5px; line-height:22px; text-align:left; }
</style>

<script>
    $(function () {
        window.print();
    })
</script>
<div class="gridPanel">
    @if (list != null && list.Count > 0)
    {
        for (int i = 0; i < list.Count; i++)
        {
            <div style="margin:5px auto; width:100%;" class="printArea">
                <div style="text-align:center;font-size:26px;">设备保养单</div>
                <table class="form" cellspacing="0" style="width:100%;">
                    <tr>
                        <td class="formTitle1" style="width:90px;">保养单编号：</td>
                        <td class="formValue1" style="width:100px;">
                            <span>@list[i].fnumber</span>
                        </td>
                        <td class="formTitle1" style="width:80px;">保养月份：</td>
                        <td class="formValue1" style="width:80px;">
                            <span>@(list[i].fplanyear + "年" + list[i].fplanmonth + "月")</span>
                        </td>
                        <td class="formTitle1" style="width:80px;">保养班组：</td>
                        <td class="formValue1" style="width:80px;">
                            <span>@list[i].itemname</span>
                        </td>
                        <td class="formTitle1" style="width:50px;">物业：</td>
                        <td class="formValue1">
                            <span>@list[i].property_name</span>
                        </td>
                    </tr>
                </table>
                <table class="form" cellspacing="0">                    
                    <tr>
                        <td class="formTitle1 tdBorder" style="width:120px;">设备编号</td>
                        <td class="formValue1 tdBorder" colspan="3">
                            <span>@list[i].d_number</span>&nbsp;
                        </td>
                        <td class="formTitle1 tdBorder" style="width:120px;">设备名称</td>
                        <td class="formValue1 tdBorder" colspan="3">
                            <span>@list[i].d_name</span>
                        </td>
                    </tr>
                    <tr>
                        <td class="formTitle1 tdBorder">设备型号</td>
                        <td class="formValue1 tdBorder" colspan="3">
                            <span>@list[i].d_standard</span>&nbsp;
                        </td>
                        <td class="formTitle1 tdBorder">安装位置</td>
                        <td class="formValue1 tdBorder" colspan="3">
                            <span>@list[i].d_place</span>
                        </td>
                    </tr>
                    <tr>
                        <td class="formTitle1 tdBorder">部件编号</td>
                        <td class="formValue1 tdBorder" colspan="3">
                            <span>@list[i].p_number</span>&nbsp;
                        </td>
                        <td class="formTitle1 tdBorder">部件名称</td>
                        <td class="formValue1 tdBorder" colspan="3">
                            <span>@list[i].p_name</span>
                        </td>
                    </tr>
                    <tr>
                        <td class="formTitle1 tdBorder">部件型号</td>
                        <td class="formValue1 tdBorder" colspan="3">
                            <span>@list[i].p_standard</span>&nbsp;
                        </td>
                        <td class="formTitle1 tdBorder">安装位置</td>
                        <td class="formValue1 tdBorder" colspan="3">
                            <span>@list[i].p_place</span>
                        </td>
                    </tr>
                    <tr>
                        <td class="formTitle1 tdBorder">上次保养日期</td>
                        <td class="formValue1 tdBorder" colspan="3">
                            <span>@(string.IsNullOrEmpty(list[i].lastdate)?"":Convert.ToDateTime(list[i].lastdate).ToString("yyyy-MM-dd"))</span>&nbsp;
                        </td>
                        <td class="formTitle1 tdBorder">上次保养人</td>
                        <td class="formValue1 tdBorder" colspan="3">
                            <span>@list[i].lastman</span>
                        </td>
                    </tr>
                    <tr>
                        <td class="formTitle1 tdBorder">上次保养内容</td>
                        <td class="formValue1 tdBorder" colspan="7">
                            <span>@list[i].lastinfo</span>&nbsp;
                        </td>
                    </tr>
                    <tr>
                        <td class="formTitle1 tdBorder">计划保养等级</td>
                        <td class="formValue1 tdBorder" colspan="3">
                            <span>@list[i].maintencename</span>&nbsp;
                        </td>
                        <td class="formTitle1 tdBorder">计划下达日期</td>
                        <td class="formValue1 tdBorder" colspan="3">
                            <span>@(DateTime.Now.ToString("yyyy-MM-dd"))</span>
                        </td>
                    </tr>
                    <tr>
                        <td class="formTitle1 tdBorder">计划保养内容</td>
                        <td class="formValue1 tdBorder" colspan="7" style="line-height:18px;">
                            <span>@list[i].maintence</span>&nbsp;
                        </td>
                    </tr>

                    <tr>
                        <td class="formTitle1 tdBorder">本次保养日期</td>
                        <td class="formValue1 tdBorder" colspan="3">
                            <span></span>&nbsp;
                        </td>
                        <td class="formTitle1 tdBorder">本次保养人</td>
                        <td class="formValue1 tdBorder" colspan="3">
                            <span></span>
                        </td>
                    </tr>
                    <tr>
                        <td class="formTitle1 tdBorder">本次保养内容</td>
                        <td class="formValue1 tdBorder" colspan="7">&nbsp;
                            <span></span>
                        </td>
                    </tr>

                    <tr style="height:26px;">
                        <td class="formTitle1">填单人</td>
                        <td class="formValue1" colspan="3">
                            <span></span>
                        </td>
                        <td class="formTitle1">领班</td>
                        <td class="formValue1" colspan="3">
                            <span></span>
                        </td>
                    </tr>
                </table>
            </div>
        
            if ((i+1)%3 == 0)
            {
                @Html.Raw("<div  style='page-break-after:always;'></div>");
            }
        }
    }
</div>